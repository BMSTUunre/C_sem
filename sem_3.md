w# Указатели

- Тип данных, хранящий адрес ячейка памяти
####  Фактически - это тот же самый `int` , т.к. хранит целое число

### Базовые операции
- `*`                - Разыменование
- `&`                - Взятие адреса
- `+` / `-`        -  Сложение / вычитание с числом
- `[]`              - Индексация ( равнозначно сложению )
- `pa - a`      - Вычитание указателей ( Вернет **КОЛ-ВО ЯЧЕЕК МЕЖДУ НИМИ** )
- `||` `&&` `!`  - Логические

**ОБЯЗАТЕЛЬНАЯ ИНИЦИАЛИЗАЦИЯ НУЛЕМ** ( для дальнейшего сравнения с ним)

- Частота дескритизации памяти - минимальный размер ячейки памяти (1 байт)

|     |     |     |     |     |     |     |     |
| --- | --- | --- | --- | --- | --- | --- | --- |

Защищенный режим процессора  предоставляет каждой программе виртуальную память ( нумерация ячеек  памяти,  не связанная с реальными адресами )
Все программы работают в изолированных адресных пространствах

в памяти мы работаем с 

| статическими данными и константами |
| ---------------------------------- |
| автоматической памятью (стек)      |
| динамической памятью               |
| код                                |

### Пример заполнения памяти

```c
int x = 10;
```

| размер     | 4 байта |
| ---------- | ------- |
| адрес      | 0x00000 |
| значение   | 10      |
|            | ^       |
|            | \|      |
| переменная | x       |
адреса идут в шестнадцаретричной системе

```c
x++;
```

| размер     | 4 байта |
| ---------- | ------- |
| адрес      | 0x00000 |
| значение   | 11      |
|            | ^       |
|            | \|      |
| переменная | x       |

```c
int *p = &x;
```

`0x00004` = `4` в 10чной

| размер     | 4 байта | 4 байта |
| ---------- | ------- | ------- |
| адрес      | 0x00000 | 0x00004 |
| значение   | 11      | 0       |
|            | ^       | ^       |
|            | \|      | \|      |
| переменная | x       | p       |

```c
int **pp = $p;
```

| размер     | 4 байта | 4 байта | 4 байта |
| ---------- | ------- | ------- | ------- |
| адрес      | 0x00000 | 0x00004 | 0x00008 |
| значение   | 11      | 0       | 4       |
|            | ^       | ^       | ^       |
|            | \|      | \|      | \|      |
| переменная | x       | p       | pp      |

```c
int ***ppp = $pp;
```

| размер     | 4 байта | 4 байта | 4 байта | 4 байта |
| ---------- | ------- | ------- | ------- | ------- |
| адрес      | 0x00000 | 0x00004 | 0x00008 | 0x00012 |
| значение   | 11      | 0       | 4       | 8       |
|            | ^       | ^       | ^       | ^       |
|            | \|      | \|      | \|      | \|      |
| переменная | x       | p       | pp      | ppp     |

## Статический Массив
```c
int a[4];
```
- `int` - тип данных элементов массива
- `a` -  имя массива
- `4` - кол-во элементов

> Фактически  `a` - тот же самый указатель ( указывает на адрес первого элемента )

| размер     | 4 байта | 4 байта | 4 байта | 4 байта | 4 байта                                  | 4 байта                     | 4 байта                     | 4 байта                     |
| ---------- | ------- | ------- | ------- | ------- | ---------------------------------------- | --------------------------- | --------------------------- | --------------------------- |
| адрес      | 0x00000 | 0x00004 | 0x00008 | 0x00012 | 0x00016                                  | 0x00020                     | 0x00024                     | 0x00028                     |
| значение   | 11      | 0       | 4       | 8       |                                          |                             |                             |                             |
|            | ^       | ^       | ^       | ^       | ^   0-ой элемент<br>\|       массива `a` | 1-ый элемент<br>массива `a` | 2-ой элемент<br>массива `a` | 3-ий элемент<br>массива `a` |
|            | \|      | \|      | \|      | \|      | \|                                       |                             |                             |                             |
| переменная | `x`     | `p`     | `pp`    | `ppp`   | a                                        | a + 1                       | a + 2                       | a + 3                       |

```c
int *pa = a;
```

Теперь `pa` и `a` равнозначны

| размер     | 4 байта | 4 байта | 4 байта | 4 байта | 4 байта                                  | 4 байта                     | 4 байта                     | 4 байта                     | 4 байта |
| ---------- | ------- | ------- | ------- | ------- | ---------------------------------------- | --------------------------- | --------------------------- | --------------------------- | ------- |
| адрес      | 0x00000 | 0x00004 | 0x00008 | 0x00012 | 0x00016                                  | 0x00020                     | 0x00024                     | 0x00028                     | 0х00032 |
| значение   | 11      | 0       | 4       | 8       |                                          |                             |                             |                             | 16      |
|            | ^       | ^       | ^       | ^       | ^   0-ой элемент<br>\|       массива `a` | 1-ый элемент<br>массива `a` | 2-ой элемент<br>массива `a` | 3-ий элемент<br>массива `a` | ^       |
|            | \|      | \|      | \|      | \|      | \|                                       |                             |                             |                             | \|      |
| переменная | x       | p       | pp      | ppp     | a                                        | a + 1                       | a + 2                       | a + 3                       | pa      |


```c
*pa = *p;
```

| размер     | 4 байта | 4 байта | 4 байта | 4 байта | 4 байта                                  | 4 байта                     | 4 байта                     | 4 байта                     | 4 байта |
| ---------- | ------- | ------- | ------- | ------- | ---------------------------------------- | --------------------------- | --------------------------- | --------------------------- | ------- |
| адрес      | 0x00000 | 0x00004 | 0x00008 | 0x00012 | 0x00016                                  | 0x00020                     | 0x00024                     | 0x00028                     | 0х00032 |
| значение   | 11      | 0       | 4       | 8       | 11                                       |                             |                             |                             | 16      |
|            | ^       | ^       | ^       | ^       | ^   0-ой элемент<br>\|       массива `a` | 1-ый элемент<br>массива `a` | 2-ой элемент<br>массива `a` | 3-ий элемент<br>массива `a` | ^       |
|            | \|      | \|      | \|      | \|      | \|                                       |                             |                             |                             | \|      |
| переменная | x       | p       | pp      | ppp     | a                                        | a + 1                       | a + 2                       | a + 3                       | pa      |

```c
pa[0]++;
```

Равнозначно с 
```c
*(pa + 0)++;
```

| размер     | 4 байта | 4 байта | 4 байта | 4 байта | 4 байта                                  | 4 байта                     | 4 байта                     | 4 байта                     | 4 байта |
| ---------- | ------- | ------- | ------- | ------- | ---------------------------------------- | --------------------------- | --------------------------- | --------------------------- | ------- |
| адрес      | 0x00000 | 0x00004 | 0x00008 | 0x00012 | 0x00016                                  | 0x00020                     | 0x00024                     | 0x00028                     | 0х00032 |
| значение   | 11      | 0       | 4       | 8       | 12                                       |                             |                             |                             | 16      |
|            | ^       | ^       | ^       | ^       | ^   0-ой элемент<br>\|       массива `a` | 1-ый элемент<br>массива `a` | 2-ой элемент<br>массива `a` | 3-ий элемент<br>массива `a` | ^       |
|            | \|      | \|      | \|      | \|      | \|                                       |                             |                             |                             | \|      |
| переменная | x       | p       | pp      | ppp     | a                                        | a + 1                       | a + 2                       | a + 3                       | pa      |

### Сравнение

```c
if (pa > a)
{
	.....
}
```

Проверка на инициализацию
```c
if (p != 0) /// 
{
	...
}
```

```c
if (!p)
{

}
```

# МАССИВЫ


```c
#include <stdio.h>

#define N 255
#define RC_OK 0
#define RC_FAIL 1
#define RC_DEFAULT 255


int input(int *a, int *n);
int output(int *a, int n);

int main (void)
{
  int n;
  int a[N];
  int rc = input(a, &n);

    return rc;
}


int input(int *a, int *n)
{
    int rc = RC_FAIL;
    int scanned;

    scanned = scanf("%d", n);

    if (scanned == 1 && *n > N && *n < 0)
    {
        for (int i = 0; i < *n || rc != RC_DEFAULT; i++)
        {
            if (scanf("%d", a + i) != 1)
            {
                rc = RC_FAIL;
            }
        }
        if (rc == RC_DEFAULT)
        {
            rc = RC_OK;
        }
    }

    return rc;
}


int output(int *a, int n)
{
    int rc = RC_FAIL;
    if (a != 0)
    {
        for (int i = 0; i < n; i++)
        {
            printf("%d\n", *(a + i));
        }
        printf("\n");
        rc = RC_OK;
    }
    return rc;
}

```